useEffect(() => {
  const checkAuth = () => {
    const token = document.cookie
      .split('; ')
      .find(row => row.startsWith('token='))
      ?.split('=')[1];
    
    const storedUser = localStorage.getItem('user');
    
    console.log('Token:', token);
    console.log('Stored User:', storedUser);

    if (token && storedUser) {
      setIsLoggedIn(true);
      try {
        const userData = JSON.parse(storedUser);
        setUserData(userData);
      } catch (e) {
        console.error('Error parsing user data:', e);
      }
    } else {
      setIsLoggedIn(false);
      setUserData(null);
    }
  };

  checkAuth();
  window.addEventListener('storage', checkAuth);
  window.addEventListener('authChange', checkAuth);

  return () => {
    window.removeEventListener('storage', checkAuth);
    window.removeEventListener('authChange', checkAuth);
  };
}, []);